{"version":3,"sources":["../../src/Dim.ts","../../src/Msg.ts","../../src/index.ts","../../src/Menu.ts","../../src/Box.ts","../../src/Pos.ts","../../src/Model.ts","../../src/Popover.ts","../../src/StopEvent.ts","../../src/TeaPop.ts","../../src/ViewMenu.tsx","../../src/ItemRenderer.tsx","Demo.tsx","App.tsx","index.tsx"],"names":["Dim","w","h","dim","zero","tag","d","uuid","r","key","m","item","subMenuCounter","selectFirst","Menu","elements","this","selectIndex","select","e","ListWithSelection","fromArray","toArray","isSelected","start","elems","i","length","just","nothing","down","getSelectedIndex","map","selectedIndex","findNextItemIndex","findPreviousItemIndex","nextIndex","withDefault","withDefaultSupply","indexOf","selected","getSelected","type","value","menuId","btoa","menuItemId","itemIndex","byId","id","Task","fromLambda","document","getElementById","Error","items","userData","subMenu","maybeOf","separator","Box","p","rect","x","y","height","width","box","pos","Pos","origin","menuStatePlacing","refBox","menu","windowSize","state","error","child","navigatedWithKeyboard","model","viewport","elem","viewportW","refX","refW","elemW","pX","offset","len","pY","console","log","place1DStart","stopEvent","preventDefault","stopPropagation","open","initialModel","selectFirstItem","deselectAll","Cmd","batch","perform","getWindowDimensions","gotWindowDimensions","u","gotUuid","postOpen","noCmd","attempt","menuTask","fromDomRect","getBoundingClientRect","gotMenuBox","withOut","mac","outMsg","outItemSelected","data","openSubMenu","isNothing","Tuple","t2n","menuItemTask","gotItemBox","update","msg","match","menuBox","place","err","collapseLastSubMenu","keyboardNavigated","mapLastMenu","lastModel","moveSelection","selectedItem","indexOfItem","expandLastSubMenu","toggleOrSelectItem","newModel","selectItem","isJust","itemBox","newModel2","childMsg","mco","windowEvents","WindowEvents","documentEvents","DocumentEvents","Sub","on","window","innerWidth","innerHeight","evt","button","noop","t","target","classList","contains","parentElement","docMouseDown","gotKeyDown","none","succeedLazy","f","fromNative","mapFirst","c","mapSecond","cmd","toNative","ViewMenuItem","props","renderer","dispatch","onMouseEnter","onMouseLeave","onClick","active","hasSubMenu","ViewMenu","renderItems","element","index","className","style","position","top","left","bottom","right","overflow","onContextMenu","visibility","contentRenderer","input","activeClass","initialMainPage","menuModel","lastClicked","mainPageMsg","menuMsg","mySubMenu2","mySubMenu1","myMenu","MyRenderer","defaultItemRenderer","s","init","mousePos","page","view","mainPage","TM","onMouseDown","href","viewMainPage","placementPage","viewportDim","vd","elemDim","refDim","placedBox","viewDim","viewPos","viewPlacementPage","mpMsg","newPage","out","mac2","closeMenu","updateMenu","openPlacementPage","mapRight","subscriptions","mouseMove","pageX","pageY","keyDown","menuSub","mm","mc","mapLeft","App","Demo","devTools","DevTools","ReactDOM","render","StrictMode"],"mappings":"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","file":"static/js/main.feff5997.chunk.js","sourcesContent":["/*\n * MIT License\n *\n * Copyright (c) 2020 Rémi Van Keisbelck\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n *\n */\n\nexport class Dim {\n  constructor(readonly w: number, readonly h: number) {}\n\n  static zero: Dim = dim(0);\n}\n\nexport function dim(w: number, h?: number): Dim {\n  return new Dim(w, h ?? w);\n}\n","/*\n * MIT License\n *\n * Copyright (c) 2020 Rémi Van Keisbelck\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n *\n */\n\nimport { Dim } from './Dim';\nimport { Box } from './Box';\nimport { Result } from 'react-tea-cup';\nimport { MenuItem } from './Menu';\n\nexport type Msg<T> =\n  | { tag: 'got-window-dimensions'; d: Dim }\n  | { tag: 'got-uuid'; uuid: string }\n  | { tag: 'got-menu-box'; r: Result<Error, Box> }\n  | { tag: 'key-down'; key: string }\n  | { tag: 'mouse-enter'; item: MenuItem<T>; itemIndex: number }\n  | { tag: 'mouse-leave'; item: MenuItem<T>; itemIndex: number }\n  | {\n      tag: 'got-item-box';\n      item: MenuItem<T>;\n      r: Result<Error, Box>;\n      selectFirst: boolean;\n      subMenuCounter: number;\n    }\n  | { tag: 'item-clicked'; item: MenuItem<T> }\n  | { tag: 'child-msg'; m: Msg<T> }\n  | { tag: 'doc-mouse-down' }\n  | { tag: 'noop' };\n\nexport function noop<T>(): Msg<T> {\n  return { tag: 'noop' };\n}\n\nexport function gotWindowDimensions<T>(d: Dim): Msg<T> {\n  return {\n    tag: 'got-window-dimensions',\n    d,\n  };\n}\n\nexport function gotUuid<T>(uuid: string): Msg<T> {\n  return {\n    tag: 'got-uuid',\n    uuid,\n  };\n}\n\nexport function gotMenuBox<T>(r: Result<Error, Box>): Msg<T> {\n  return {\n    tag: 'got-menu-box',\n    r,\n  };\n}\n\nexport function gotKeyDown<T>(key: string): Msg<T> {\n  return {\n    tag: 'key-down',\n    key,\n  };\n}\n\nexport function childMsg<T>(m: Msg<T>): Msg<T> {\n  return {\n    tag: 'child-msg',\n    m,\n  };\n}\n\nexport function gotItemBox<T>(\n  item: MenuItem<T>,\n  r: Result<Error, Box>,\n  subMenuCounter: number,\n  selectFirst: boolean,\n): Msg<T> {\n  return {\n    tag: 'got-item-box',\n    item,\n    selectFirst,\n    r,\n    subMenuCounter,\n  };\n}\n\nexport function docMouseDown<T>(): Msg<T> {\n  return {\n    tag: 'doc-mouse-down',\n  };\n}\n","/*\n * MIT License\n *\n * Copyright (c) 2020 Rémi Van Keisbelck\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n *\n */\n\nexport * from './Model';\nexport * from './Msg';\nexport * from './Menu';\nexport * from './TeaPop';\nexport * from './ViewMenu';\nexport * from './OutMsg';\nexport * from './StopEvent';\nexport * from './Pos';\nexport * from './Dim';\nexport * from './Box';\nexport * from './ItemRenderer';\nexport * from './Popover';\n","/*\n * MIT License\n *\n * Copyright (c) 2020 Rémi Van Keisbelck\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n *\n */\n\nimport {\n  just,\n  ListWithSelection,\n  Maybe,\n  maybeOf,\n  nothing,\n  Task,\n} from 'react-tea-cup';\n\nexport class Menu<T> {\n  constructor(private readonly elements: ListWithSelection<MenuElement<T>>) {}\n\n  selectFirstItem(): Menu<T> {\n    return new Menu(this.elements.selectIndex(0));\n  }\n\n  selectItem(item: MenuItem<T>): Menu<T> {\n    return new Menu(this.elements.select((e) => e === item));\n  }\n\n  deselectAll(): Menu<T> {\n    return new Menu(ListWithSelection.fromArray(this.elements.toArray()));\n  }\n\n  get elems(): ReadonlyArray<MenuElement<T>> {\n    return this.elements.toArray();\n  }\n\n  get selectedItem(): Maybe<MenuItem<T>> {\n    const selected = this.elements.getSelected();\n    if (selected.type === 'Just' && selected.value.tag === 'item') {\n      return just(selected.value);\n    }\n    return nothing;\n  }\n\n  isSelected(item: MenuItem<T>): boolean {\n    return this.elements.isSelected(item);\n  }\n\n  private findNextItemIndex(start: number): Maybe<number> {\n    const elems = this.elems;\n    const s = start === elems.length - 1 ? 0 : start + 1;\n    for (let i = s; i < elems.length; i++) {\n      if (elems[i].tag === 'item') {\n        return just(i);\n      }\n    }\n    return nothing;\n  }\n\n  private findPreviousItemIndex(start: number): Maybe<number> {\n    const elems = this.elems;\n    const s = start === 0 ? elems.length - 1 : start - 1;\n    for (let i = s; i >= 0; i--) {\n      if (elems[i].tag === 'item') {\n        return just(i);\n      }\n    }\n    return nothing;\n  }\n\n  moveSelection(down: boolean): Menu<T> {\n    return this.elements\n      .getSelectedIndex()\n      .map((selectedIndex) => {\n        const mbNextIndex = down\n          ? this.findNextItemIndex(selectedIndex)\n          : this.findPreviousItemIndex(selectedIndex);\n        return mbNextIndex\n          .map((nextIndex) => new Menu(this.elements.selectIndex(nextIndex)))\n          .withDefault(this);\n      })\n      .withDefaultSupply(() => {\n        return new Menu(\n          this.elements.selectIndex(down ? 0 : this.elements.length() - 1),\n        );\n      });\n  }\n\n  indexOfItem(item: MenuItem<T>): Maybe<number> {\n    const i = this.elements.toArray().indexOf(item);\n    if (i === -1) {\n      return nothing;\n    }\n    return just(i);\n  }\n}\n\nexport type MenuElement<T> = MenuItem<T> | MenuSeparator;\n\nexport interface MenuItem<T> {\n  tag: 'item';\n  readonly userData: T;\n  readonly subMenu: Maybe<Menu<T>>;\n}\n\nexport interface MenuSeparator {\n  tag: 'separator';\n}\n\nexport function menu<T>(items: ReadonlyArray<MenuElement<T>>): Menu<T> {\n  return new Menu(ListWithSelection.fromArray(items));\n}\n\nexport function item<T>(userData: T, subMenu?: Menu<T>): MenuItem<T> {\n  return {\n    tag: 'item',\n    userData,\n    subMenu: maybeOf(subMenu),\n  };\n}\n\nexport const separator: MenuSeparator = {\n  tag: 'separator',\n};\n\nexport function menuId(uuid: string): string {\n  return `tm-${btoa(uuid)}`;\n}\n\nexport function menuItemId(menuId: string, itemIndex: number): string {\n  return `tm-item-${menuId}-${itemIndex}`;\n}\n\nexport function menuTask(uuid: string): Task<Error, HTMLElement> {\n  return byId(menuId(uuid));\n}\n\nexport function menuItemTask(\n  menuId: string,\n  itemIndex: number,\n): Task<Error, HTMLElement> {\n  return byId(menuItemId(menuId, itemIndex));\n}\n\nfunction byId(id: string): Task<Error, HTMLElement> {\n  return Task.fromLambda(() => {\n    const e = document.getElementById(id);\n    if (e === null) {\n      throw new Error('element not found with id:' + id);\n    }\n    return e;\n  });\n}\n","/*\n * MIT License\n *\n * Copyright (c) 2020 Rémi Van Keisbelck\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n *\n */\n\nimport { pos, Pos } from './Pos';\nimport { dim, Dim } from './Dim';\n\nexport class Box {\n  constructor(readonly p: Pos, readonly d: Dim) {}\n\n  static fromDomRect(rect: DOMRect): Box {\n    const { x, y, height, width } = rect;\n    return box(pos(x, y), dim(width, height));\n  }\n}\n\nexport function box(p: Pos, d: Dim): Box {\n  return new Box(p, d);\n}\n","/*\n * MIT License\n *\n * Copyright (c) 2020 Rémi Van Keisbelck\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n *\n */\n\nexport class Pos {\n  constructor(readonly x: number, readonly y: number) {}\n\n  add(p: Pos): Pos {\n    return new Pos(this.x + p.x, this.y + p.y);\n  }\n\n  static origin: Pos = pos(0, 0);\n}\n\nexport function pos(x: number, y: number): Pos {\n  return new Pos(x, y);\n}\n","/*\n * MIT License\n *\n * Copyright (c) 2020 Rémi Van Keisbelck\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n *\n */\n\nimport { Menu } from './Menu';\nimport { Maybe, nothing } from 'react-tea-cup';\nimport { Dim } from './Dim';\nimport { Box } from './Box';\n\nexport interface Model<T> {\n  readonly uuid: Maybe<string>;\n  readonly windowSize: Maybe<Dim>;\n  readonly menu: Menu<T>;\n  readonly state: MenuState;\n  readonly error: Maybe<Error>;\n  readonly child: Maybe<Model<T>>;\n  readonly navigatedWithKeyboard: boolean;\n  readonly subMenuCounter: number;\n}\n\nexport function initialModel<T>(menu: Menu<T>, refBox: Box): Model<T> {\n  return {\n    uuid: nothing,\n    windowSize: nothing,\n    menu,\n    state: menuStatePlacing(refBox),\n    error: nothing,\n    child: nothing,\n    navigatedWithKeyboard: false,\n    subMenuCounter: 0,\n  };\n}\n\nexport type MenuState =\n  | { tag: 'placing'; refBox: Box }\n  | { tag: 'open'; box: Box };\n\nexport function menuStatePlacing(refBox: Box): MenuState {\n  return {\n    tag: 'placing',\n    refBox,\n  };\n}\n\nexport function keyboardNavigated<T>(\n  model: Model<T>,\n  navigatedWithKeyboard = true,\n): Model<T> {\n  return { ...model, navigatedWithKeyboard };\n}\n","/*\n * MIT License\n *\n * Copyright (c) 2020 Rémi Van Keisbelck\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n *\n */\n\nimport { box, Box } from './Box';\nimport { dim, Dim } from './Dim';\nimport { pos } from './Pos';\n\nexport function place(viewport: Dim, refBox: Box, elem: Dim): Box {\n  const pX = place1DEnd(viewport.w, refBox.p.x, refBox.d.w, elem.w);\n  const pY = place1DStart(viewport.h, refBox.p.y, refBox.d.h, elem.h);\n  return box(pos(pX.offset, pY.offset), dim(pX.len, pY.len));\n}\n\ninterface Placed1D {\n  readonly offset: number;\n  readonly len: number;\n}\n\nfunction place1DEnd(\n  viewportW: number,\n  refX: number,\n  refW: number,\n  elemW: number,\n): Placed1D {\n  if (refX + refW + elemW > viewportW) {\n    // not enough space after, try before\n    if (elemW < refX) {\n      // ok, prepend\n      return { offset: refX - elemW, len: elemW };\n    } else {\n      // not enough space before or after, we have to translate and/or expand !\n      if (elemW < viewportW) {\n        // can't append or prepend, but no need to shrink... translate only\n        const delta = refX + refW + elemW - viewportW;\n        return { offset: refX + refW - delta, len: elemW };\n      }\n      return { offset: 0, len: viewportW };\n    }\n  } else {\n    // enough space to append\n    return { offset: refX + refW, len: elemW };\n  }\n}\n\nfunction place1DStart(\n  viewportW: number,\n  refX: number,\n  refW: number,\n  elemW: number,\n): Placed1D {\n  if (elemW > viewportW) {\n    return { offset: 0, len: viewportW };\n  }\n  if (refX + elemW > viewportW) {\n    // not enough space after, try before\n    if (elemW < refX + refW) {\n      // ok, prepend\n      return { offset: refX + refW - elemW, len: elemW };\n    } else {\n      // not enough space before or after, we have to translate and/or expand !\n      if (elemW < viewportW) {\n        console.log('shrink');\n        // can't append or prepend, but no need to shrink... translate only\n        const delta = refX + refW + elemW - viewportW;\n        return { offset: refX + refW - delta, len: elemW };\n      }\n      return { offset: 0, len: 10 };\n    }\n  } else {\n    // enough space to append\n    return { offset: refX, len: elemW };\n  }\n}\n","/*\n * MIT License\n *\n * Copyright (c) 2020 Rémi Van Keisbelck\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n *\n */\n\nimport { EventHandler } from 'react';\n\nexport const stopEvent: EventHandler<any> = (e) => {\n  e.preventDefault();\n  e.stopPropagation();\n};\n","/*\n * MIT License\n *\n * Copyright (c) 2020 Rémi Van Keisbelck\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n *\n */\n\nimport {\n  childMsg,\n  docMouseDown,\n  gotItemBox,\n  gotKeyDown,\n  gotMenuBox,\n  gotUuid,\n  gotWindowDimensions,\n  Msg,\n  noop,\n} from './Msg';\nimport {\n  Cmd,\n  DocumentEvents,\n  just,\n  Maybe,\n  noCmd,\n  nothing,\n  Sub,\n  Task,\n  Tuple,\n  uuid,\n  WindowEvents,\n} from 'react-tea-cup';\nimport { initialModel, keyboardNavigated, Model } from './Model';\nimport { Menu, MenuItem, menuItemTask, menuTask } from './Menu';\nimport { dim, Dim } from './Dim';\nimport { Box } from './Box';\nimport { OutMsg } from './OutMsg';\nimport { place } from './Popover';\n\nexport function open<T>(\n  menu: Menu<T>,\n  refBox: Box,\n  selectFirst = false,\n): [Model<T>, Cmd<Msg<T>>] {\n  return [\n    initialModel(\n      selectFirst ? menu.selectFirstItem() : menu.deselectAll(),\n      refBox,\n    ),\n    Cmd.batch([\n      Task.perform(getWindowDimensions, (d) => gotWindowDimensions(d)),\n      Task.perform(uuid(), (u) => gotUuid(u)),\n    ]),\n  ];\n}\n\nfunction postOpen<T>(model: Model<T>): [Model<T>, Cmd<Msg<T>>] {\n  if (model.uuid.type === 'Nothing') {\n    return noCmd(model);\n  }\n  if (model.windowSize.type === 'Nothing') {\n    return noCmd(model);\n  }\n  const cmd: Cmd<Msg<T>> = Task.attempt(\n    menuTask(model.uuid.value).map((e) =>\n      Box.fromDomRect(e.getBoundingClientRect()),\n    ),\n    (x) => gotMenuBox(x),\n  );\n  return [model, cmd];\n}\n\nfunction withOut<T>(\n  mac: [Model<T>, Cmd<Msg<T>>],\n  outMsg: Maybe<OutMsg<T>> = nothing,\n): [Model<T>, Cmd<Msg<T>>, Maybe<OutMsg<T>>] {\n  return [mac[0], mac[1], outMsg];\n}\n\nexport function update<T>(\n  msg: Msg<T>,\n  model: Model<T>,\n): [Model<T>, Cmd<Msg<T>>, Maybe<OutMsg<T>>] {\n  switch (msg.tag) {\n    case 'got-window-dimensions': {\n      return withOut(\n        postOpen({\n          ...model,\n          windowSize: just(msg.d),\n        }),\n      );\n    }\n    case 'got-uuid': {\n      return withOut(\n        postOpen({\n          ...model,\n          uuid: just(msg.uuid),\n        }),\n      );\n    }\n    case 'got-menu-box': {\n      if (model.state.tag === 'placing') {\n        const state = model.state;\n        return withOut(\n          noCmd(\n            model.windowSize\n              .map((windowSize) => {\n                const newModel: Model<T> = msg.r.match(\n                  (menuBox) =>\n                    ({\n                      ...model,\n                      state: {\n                        tag: 'open',\n                        box: place(windowSize, state.refBox, menuBox.d),\n                      },\n                    } as Model<T>),\n                  (err) => ({\n                    ...model,\n                    error: just(err),\n                  }),\n                );\n                return newModel;\n              })\n              .withDefault(model),\n          ),\n        );\n      }\n      return withOut(noCmd(model));\n    }\n\n    case 'key-down': {\n      switch (msg.key) {\n        case 'Escape': {\n          return withOut(\n            collapseLastSubMenu(keyboardNavigated(model)),\n            model.child.isNothing() ? just({ tag: 'request-close' }) : nothing,\n          );\n        }\n        case 'ArrowDown':\n        case 'ArrowUp': {\n          return mapLastMenu(keyboardNavigated(model), (lastModel) => {\n            return withOut(\n              noCmd({\n                ...lastModel,\n                menu: lastModel.menu.moveSelection(msg.key === 'ArrowDown'),\n              }),\n            );\n          });\n        }\n        case 'ArrowLeft':\n          return withOut(collapseLastSubMenu(keyboardNavigated(model)));\n        case 'ArrowRight':\n          return expandLastSubMenu(keyboardNavigated(model));\n        case 'Enter':\n        case ' ': {\n          return toggleOrSelectItem(model);\n        }\n        default:\n          return withOut(noCmd(model));\n      }\n    }\n    case 'mouse-enter': {\n      const newModel = { ...model, subMenuCounter: model.subMenuCounter + 1 };\n      if (model.navigatedWithKeyboard) {\n        return withOut(noCmd(keyboardNavigated(newModel, false)));\n      }\n      if (model.uuid.type === 'Nothing') {\n        return withOut(noCmd(newModel));\n      }\n      const menu = model.menu.selectItem(msg.item);\n      const uuid = model.uuid.value;\n      return withOut(\n        openSubMenu(\n          { ...newModel, menu, child: nothing },\n          uuid,\n          msg.item,\n          msg.itemIndex,\n          false,\n        ),\n      );\n    }\n    case 'mouse-leave': {\n      return withOut(\n        noCmd(\n          model.child.isJust()\n            ? model\n            : { ...model, menu: model.menu.deselectAll() },\n        ),\n      );\n    }\n    case 'got-item-box': {\n      if (msg.subMenuCounter !== model.subMenuCounter) {\n        return withOut(noCmd(model));\n      }\n      return withOut(\n        msg.r.match(\n          (itemBox) => {\n            const newModel: Model<T> = {\n              ...model,\n              menu: model.menu.selectItem(msg.item),\n            };\n            return msg.item.subMenu\n              .map((subMenu) => {\n                // we have a sub menu so we need\n                // to open a new Menu !\n                const mac = open(subMenu, itemBox, msg.selectFirst);\n                const newModel2: Model<T> = {\n                  ...newModel,\n                  child: just(mac[0]),\n                };\n                return Tuple.t2n(newModel2, mac[1].map(childMsg));\n              })\n              .withDefaultSupply(() => {\n                // close any existing child !\n                return newModel.child\n                  .map(() =>\n                    noCmd<Model<T>, Msg<T>>({ ...model, child: nothing }),\n                  )\n                  .withDefaultSupply(() => noCmd(model));\n              });\n          },\n          (err) => noCmd({ ...model, error: just(err) }),\n        ),\n      );\n    }\n    case 'child-msg': {\n      return model.child\n        .map((child) => {\n          const mco = update(msg.m, child);\n          const newModel: Model<T> = {\n            ...model,\n            child: just(mco[0]),\n          };\n          return withOut(Tuple.t2n(newModel, mco[1].map(childMsg)), mco[2]);\n        })\n        .withDefaultSupply(() => withOut(noCmd(model)));\n    }\n    case 'item-clicked': {\n      return withOut(noCmd(model), outItemSelected(msg.item));\n    }\n    case 'doc-mouse-down': {\n      return withOut(noCmd(model), just({ tag: 'request-close' }));\n    }\n    case 'noop': {\n      return withOut(noCmd(model));\n    }\n  }\n}\n\nfunction outItemSelected<T>(item: MenuItem<T>): Maybe<OutMsg<T>> {\n  return just({ tag: 'item-selected', data: item.userData });\n}\n\nfunction openSubMenu<T>(\n  model: Model<T>,\n  menuId: string,\n  item: MenuItem<T>,\n  itemIndex: number,\n  selectFirst: boolean,\n): [Model<T>, Cmd<Msg<T>>] {\n  if (item.subMenu.isNothing()) {\n    return noCmd(model);\n  }\n  const subMenuCounter = model.subMenuCounter + 1;\n  return Tuple.t2n(\n    { ...model, subMenuCounter },\n    Task.attempt(\n      menuItemTask(menuId, itemIndex).map((e) => {\n        return Box.fromDomRect(e.getBoundingClientRect());\n      }),\n      (r) => gotItemBox(item, r, subMenuCounter, selectFirst),\n    ),\n  );\n}\n\nconst windowEvents = new WindowEvents();\nconst documentEvents = new DocumentEvents();\n\nexport function subscriptions<T>(model: Model<T>): Sub<Msg<T>> {\n  return Sub.batch([\n    windowEvents.on('resize', () =>\n      gotWindowDimensions(dim(window.innerWidth, window.innerHeight)),\n    ),\n    documentEvents.on('mousedown', (evt) => {\n      if (evt.button === 2) {\n        return noop();\n      }\n      let t: HTMLElement | null = evt.target as HTMLElement;\n      while (t) {\n        // move up and try to find if we are inside a tea-pop Menu !\n        if (t.classList.contains('tm')) {\n          return noop();\n        }\n        t = t.parentElement;\n      }\n      return docMouseDown();\n    }),\n    model.state.tag === 'open'\n      ? documentEvents.on('keydown', (e) => gotKeyDown(e.key))\n      : Sub.none(),\n  ]);\n}\n\nconst getWindowDimensions: Task<never, Dim> = Task.succeedLazy(() =>\n  dim(window.innerWidth, window.innerHeight),\n);\n\nfunction mapLastMenu<T>(\n  model: Model<T>,\n  f: (m: Model<T>) => [Model<T>, Cmd<Msg<T>>, Maybe<OutMsg<T>>],\n): [Model<T>, Cmd<Msg<T>>, Maybe<OutMsg<T>>] {\n  switch (model.child.type) {\n    case 'Nothing': {\n      // I'm the last model !\n      return f(model);\n    }\n    case 'Just': {\n      const mac = mapLastMenu(model.child.value, f);\n      return [{ ...model, child: just(mac[0]) }, mac[1].map(childMsg), mac[2]];\n    }\n  }\n}\n\nfunction collapseLastSubMenu<T>(model: Model<T>): [Model<T>, Cmd<Msg<T>>] {\n  switch (model.child.type) {\n    case 'Nothing':\n      return noCmd(model);\n    case 'Just': {\n      // I have a child : close it if he has no child !\n      const child = model.child.value;\n      if (child.child.isJust()) {\n        return Tuple.fromNative(collapseLastSubMenu(child))\n          .mapFirst((c) => ({ ...model, child: just(c) }))\n          .mapSecond((cmd) => cmd.map(childMsg))\n          .toNative();\n      } else {\n        return noCmd({\n          ...model,\n          child: nothing,\n        });\n      }\n    }\n  }\n}\n\nfunction expandLastSubMenu<T>(\n  model: Model<T>,\n): [Model<T>, Cmd<Msg<T>>, Maybe<OutMsg<T>>] {\n  return mapLastMenu(model, (lastModel) => {\n    return lastModel.menu.selectedItem\n      .map((selectedItem) => {\n        return selectedItem.subMenu\n          .map(() => {\n            if (lastModel.uuid.type === 'Nothing') {\n              return withOut(noCmd<Model<T>, Msg<T>>(lastModel));\n            }\n            const uuid = lastModel.uuid.value;\n            const mac: [Model<T>, Cmd<Msg<T>>] = lastModel.menu\n              .indexOfItem(selectedItem)\n              .map((itemIndex) => {\n                return openSubMenu(\n                  lastModel,\n                  uuid,\n                  selectedItem,\n                  itemIndex,\n                  true,\n                );\n              })\n              .withDefaultSupply(() => noCmd(lastModel));\n            return withOut(mac);\n          })\n          .withDefaultSupply(() => {\n            return withOut(noCmd(lastModel));\n          });\n      })\n      .withDefaultSupply(() => {\n        return withOut(noCmd(lastModel));\n      });\n  });\n}\n\nfunction toggleOrSelectItem<T>(\n  model: Model<T>,\n): [Model<T>, Cmd<Msg<T>>, Maybe<OutMsg<T>>] {\n  return mapLastMenu(model, (lastModel) => {\n    return lastModel.menu.selectedItem\n      .map((selectedItem) => {\n        if (lastModel.uuid.type === 'Nothing') {\n          return withOut(noCmd<Model<T>, Msg<T>>(lastModel));\n        }\n        const uuid = lastModel.uuid.value;\n        // do we have a sub-menu ?\n        return selectedItem.subMenu\n          .map(() => {\n            // we have a sub-menu, expand it\n            const mac: [Model<T>, Cmd<Msg<T>>] = lastModel.menu\n              .indexOfItem(selectedItem)\n              .map((itemIndex) =>\n                openSubMenu(lastModel, uuid, selectedItem, itemIndex, true),\n              )\n              .withDefaultSupply(() => noCmd(lastModel));\n            return withOut(mac);\n          })\n          .withDefaultSupply(() => {\n            // no sub-menu, select the item\n            return withOut(noCmd(lastModel), outItemSelected(selectedItem));\n          });\n      })\n      .withDefaultSupply(() => withOut(noCmd(lastModel)));\n  });\n}\n","/*\n * MIT License\n *\n * Copyright (c) 2020 Rémi Van Keisbelck\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n *\n */\n\nimport * as React from 'react';\nimport { Menu, menuId, MenuItem, menuItemId } from './Menu';\nimport { childMsg, Msg } from './Msg';\nimport { Dispatcher, map } from 'react-tea-cup';\nimport { ItemRenderer } from './ItemRenderer';\nimport { Model } from './Model';\nimport { stopEvent } from './StopEvent';\n\nexport interface ViewMenuProps<T> {\n  model: Model<T>;\n  dispatch: Dispatcher<Msg<T>>;\n  renderer: ItemRenderer<T>;\n}\n\nexport function ViewMenu<T>(props: ViewMenuProps<T>) {\n  const { model, dispatch, renderer } = props;\n  const { menu, state, uuid, windowSize } = model;\n  if (uuid.type === 'Nothing') {\n    return <></>;\n  }\n  if (windowSize.type === 'Nothing') {\n    return <></>;\n  }\n\n  const renderItems = () =>\n    menu.elems.map((element, index) => {\n      switch (element.tag) {\n        case 'item': {\n          return (\n            <ViewMenuItem\n              key={`item-${index}`}\n              uuid={uuid.value}\n              itemIndex={index}\n              menu={menu}\n              item={element}\n              {...props}\n            />\n          );\n        }\n        case 'separator': {\n          return <div key={`sep-${index}`} className=\"tm-separator\" />;\n        }\n      }\n    });\n\n  switch (state.tag) {\n    case 'placing': {\n      const { refBox } = state;\n      return (\n        <div\n          className=\"tm-placer\"\n          style={{\n            position: 'absolute',\n            top: 0,\n            left: 0,\n            bottom: 0,\n            right: 0,\n            overflow: 'hidden',\n          }}\n          onContextMenu={stopEvent}\n        >\n          <div\n            className=\"tm\"\n            id={menuId(uuid.value)}\n            style={{\n              position: 'absolute',\n              top: refBox.p.y,\n              left: refBox.p.x,\n              visibility: 'hidden',\n            }}\n            onContextMenu={stopEvent}\n          >\n            {renderItems()}\n          </div>\n        </div>\n      );\n    }\n    case 'open': {\n      const { box } = state;\n      const { p, d } = box;\n      return (\n        <>\n          <div\n            className=\"tm\"\n            id={menuId(uuid.value)}\n            style={{\n              position: 'absolute',\n              top: p.y,\n              left: p.x,\n              width: d.w,\n              height: d.h,\n            }}\n            onContextMenu={stopEvent}\n          >\n            {renderItems()}\n          </div>\n          {model.child\n            .map((child) => (\n              <ViewMenu\n                model={child}\n                dispatch={map(dispatch, childMsg)}\n                renderer={renderer}\n              />\n            ))\n            .withDefaultSupply(() => (\n              <></>\n            ))}\n        </>\n      );\n    }\n  }\n}\n\nexport interface ViewMenuItemProps<T> {\n  uuid: string;\n  itemIndex: number;\n  menu: Menu<T>;\n  item: MenuItem<T>;\n  dispatch: Dispatcher<Msg<T>>;\n  renderer: ItemRenderer<T>;\n}\n\nexport function ViewMenuItem<T>(props: ViewMenuItemProps<T>) {\n  const { menu, item, renderer, dispatch, uuid, itemIndex } = props;\n  const selected = menu.isSelected(item);\n  return (\n    <div\n      id={menuItemId(uuid, itemIndex)}\n      onMouseEnter={() => dispatch({ tag: 'mouse-enter', item, itemIndex })}\n      onMouseLeave={() => dispatch({ tag: 'mouse-leave', item, itemIndex })}\n      onClick={() => {\n        dispatch({ tag: 'item-clicked', item });\n      }}\n    >\n      {renderer({\n        data: item.userData,\n        active: selected,\n        hasSubMenu: item.subMenu.isJust(),\n      })}\n    </div>\n  );\n}\n","/*\n * MIT License\n *\n * Copyright (c) 2020 Rémi Van Keisbelck\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n *\n */\n\nimport * as React from \"react\";\n\nexport interface RendererInput<T> {\n  readonly data: T;\n  readonly active: boolean;\n  readonly hasSubMenu: boolean;\n}\n\nexport type ItemRenderer<T> = (input: RendererInput<T>) => React.ReactNode;\n\nexport function defaultItemRenderer<T>(contentRenderer: (t: T) => React.ReactNode): ItemRenderer<T> {\n  return (input) => {\n    const { data, active, hasSubMenu } = input;\n    const activeClass = active ? ' tm-active' : '';\n    return (\n        <div className={`tm-item${activeClass}`}>\n          <div className=\"tm-item__content\">\n            {contentRenderer(data)}\n          </div>\n          { hasSubMenu\n              ? (\n                  <div className=\"tm-item__submenu\">\n                    ›\n                  </div>\n              )\n              : <></>\n          }\n        </div>\n    )\n  }\n}\n","import {\n  Cmd,\n  Dispatcher,\n  DocumentEvents,\n  Either,\n  just,\n  left,\n  map,\n  Maybe,\n  noCmd,\n  nothing,\n  right,\n  Sub,\n  Task,\n  Tuple,\n  WindowEvents\n} from \"react-tea-cup\";\nimport * as React from 'react';\nimport * as TM from 'tea-pop';\nimport {\n  box,\n  defaultItemRenderer,\n  dim,\n  Dim,\n  item,\n  Menu,\n  menu,\n  Model as TModel,\n  Msg as TMsg,\n  place,\n  pos,\n  Pos,\n  separator,\n  ViewMenu\n} from 'tea-pop';\nimport {Box} from \"tea-pop/dist/Box\";\n\nexport interface Model {\n  // keep track of mouse position\n  readonly mousePos: Pos;\n  // page to display\n  readonly page: Either<MainPage, PlacementPage>;\n}\n\ninterface MainPage {\n  // ref to the tea-pop model\n  readonly menuModel: Maybe<TModel<string>>;\n  // keep last clicked item\n  readonly lastClicked: Maybe<string>;\n}\n\nfunction initialMainPage(): MainPage {\n  return {\n    menuModel: nothing,\n    lastClicked: nothing,\n  }\n}\n\ninterface PlacementPage {\n  readonly viewportDim: Maybe<Dim>;\n}\n\nfunction openPlacementPage(model: Model): [Model, Cmd<Msg>] {\n  return Tuple.t2n(\n      {\n        ...model,\n        page: right({\n          viewportDim: nothing,\n          refDim: dim(100),\n        })\n      },\n      Task.perform(\n          Task.succeedLazy(() => dim(window.innerWidth, window.innerHeight)),\n          gotWindowDimensions\n      )\n  )\n}\n\n// just to avoid too much typing\nexport type MenuModel = TModel<string>\nexport type MenuMsg = TMsg<string>\n\n/*\n * Msg\n */\n\nexport type Msg =\n    | { tag: 'switch-page' }\n    | { tag: 'got-window-dimensions', d: Dim }\n    | { tag: 'main-page-msg', m: MainPageMsg }\n    | { tag: 'mouse-move', pos: Pos }\n    | { tag: 'placement-page-msg' }\n    | { tag: 'key-down', key: string }\n\n\ntype MainPageMsg =\n    | { tag: 'menu-msg', msg: MenuMsg }\n    | { tag: 'mouse-down', button: number }\n\nfunction mainPageMsg(m: MainPageMsg): Msg {\n  return {\n    tag: \"main-page-msg\",\n    m\n  }\n}\n\nfunction gotWindowDimensions(d: Dim): Msg {\n  return {\n    tag: \"got-window-dimensions\",\n    d\n  }\n}\n\nfunction menuMsg(msg: MenuMsg): MainPageMsg {\n  return {\n    tag: \"menu-msg\",\n    msg\n  }\n}\n\nfunction onMouseDown(button: number): Msg {\n  return mainPageMsg({\n    tag: \"mouse-down\", button\n  })\n}\n\nfunction onMouseMove(pos: Pos): Msg {\n  return{\n    tag: \"mouse-move\", pos\n  }\n}\n\nfunction onKeyDown(key: string): Msg {\n  return {\n    tag: \"key-down\", key\n  }\n}\n\n/*\n * We keep our menus as constants. Those are, like everything, immutable.\n * They will serve as prototypes for when we open menus in reaction to clicks or\n * keystrokes...\n * We use strings for our data types, but it could hold a richer data type.\n */\n\nconst mySubMenu2: Menu<string> = menu([\n  item(\"Try\"),\n  item(\"Finally\")\n])\n\nconst mySubMenu1: Menu<string> = menu([\n  item(\"Do this\"),\n  item(\"Do that\"),\n  separator,\n  item(\"Another sub menu...\", mySubMenu2)\n])\n\nconst myMenu: Menu<string> = menu([\n  item(\"Copy\"),\n  item(\"Cut\"),\n  item(\"Paste\"),\n  separator,\n  item(\"Yalla\", mySubMenu1),\n  item(\"I am a bit longer\")\n]);\n\n/**\n * We use the default item renderer with our item data type (string).\n */\n\nconst MyRenderer = defaultItemRenderer((s: string) => <span>{s}</span>);\n\n/*\n * init, view, update, subs...\n */\n\nexport function init(): [Model, Cmd<Msg>] {\n  return noCmd({\n    mousePos: Pos.origin,\n    page: left(initialMainPage()),\n  });\n}\n\nexport function view(dispatch: Dispatcher<Msg>, model: Model) {\n  return model.page.match(\n      mainPage => viewMainPage(dispatch, mainPage),\n      placementPage => viewPlacementPage(dispatch, model, placementPage),\n  )\n}\n\n\nfunction viewPlacementPage(dispatch: Dispatcher<Msg>, model: Model, page: PlacementPage) {\n  // TODO call place func to get pos/dimensions of the menu\n  // we need the viewport size for that...\n  const { viewportDim } = page;\n  return viewportDim.map(vd => {\n    const { mousePos } = model;\n    const elemDim = dim(300, 400);\n    const refDim = dim(100, 50);\n    const placedBox: Box = place(vd, box(pos(mousePos.x, mousePos.y), refDim), elemDim);\n    const viewDim = (d: Dim) => <span>{d.w}*{d.h}</span>\n    const viewPos = (p: Pos) => <span>{p.x}:{p.y}</span>\n    return (\n        <div className=\"demo\">\n          <div className=\"dimensions\">\n            <ul>\n              <li>elem: {viewDim(elemDim)}</li>\n              <li>viewport: {viewDim(vd)}</li>\n              <li>ref: {viewDim(refDim)}</li>\n              <li>mousePos: {viewPos(mousePos)}</li>\n              <li>placed: {viewPos(placedBox.p)}, {viewDim(placedBox.d)}</li>\n            </ul>\n          </div>\n          <div className=\"ref-elem\" style={{\n            height: refDim.h,\n            width: refDim.w,\n            left: model.mousePos.x,\n            top: model.mousePos.y,\n          }}>\n          </div>\n          <div className=\"menu-elem\" style={{\n            height: placedBox.d.h,\n            width: placedBox.d.w,\n            left: placedBox.p.x,\n            top: placedBox.p.y,\n          }}>\n          </div>\n        </div>\n    )\n  }).withDefaultSupply(() => <></>);\n}\n\nfunction viewMainPage(dispatch: Dispatcher<Msg>, page: MainPage) {\n  return (\n      <>\n        <div\n            className=\"demo\"\n            onContextMenu={TM.stopEvent}\n            onMouseDown={e => dispatch(onMouseDown(e.button))}\n        >\n          <div className=\"page-switch\">\n          { /* eslint-disable-next-line */ }\n          <a href=\"#\" onClick={() => dispatch({tag: \"switch-page\"})}>Placement tests</a>\n          </div>\n          {page.menuModel\n              .map(() => <span>Menu is open</span>)\n              .withDefaultSupply(() =>\n                  page.lastClicked\n                      .map(lastClicked => <span>You selected <em>{lastClicked}</em></span>)\n                      .withDefaultSupply(() =>\n                          <>\n                            <div>Right-click anywhere, or use the <code>≣</code> key.</div>\n                          </>\n                      )\n              )\n          }\n        </div>\n        {page.menuModel\n            .map(menuModel =>\n                <ViewMenu model={menuModel} dispatch={map(dispatch, m => mainPageMsg(menuMsg(m)))} renderer={MyRenderer}/>\n            )\n            .withDefault(<></>)\n        }\n      </>\n  )\n}\n\nexport function update(msg: Msg, model: Model): [Model, Cmd<Msg>] {\n  switch (msg.tag) {\n    case \"main-page-msg\": {\n      const mpMsg: MainPageMsg = msg.m;\n      switch (mpMsg.tag)  {\n        case \"menu-msg\": {\n          return model.page.match(\n              mainPage => {\n                // got child msg, update our child...\n                if (mainPage.menuModel.type === 'Nothing') {\n                  return noCmd(model);\n                }\n                const menuModel = mainPage.menuModel.value;\n                const mco = TM.update(mpMsg.msg, menuModel);\n                const newPage: MainPage = {\n                  ...mainPage,\n                  menuModel: just(mco[0])\n                };\n                const newModel: Model = {\n                  ...model, page: left(newPage)\n                };\n                const cmd: Cmd<Msg> = mco[1].map(menuMsg).map(mainPageMsg);\n                const mac: [Model, Cmd<Msg>] = [newModel, cmd];\n                // and handle its out msg if needed\n                const outMsg: Maybe<TM.OutMsg<string>> = mco[2];\n                return outMsg\n                    // eslint-disable-next-line array-callback-return\n                    .map(out => {\n                      switch (out.tag) {\n                        case \"request-close\": {\n                          const mac2 = closeMenu(newModel);\n                          return Tuple.fromNative(mac2).mapSecond(c => Cmd.batch([cmd, c])).toNative();\n                        }\n                        case \"item-selected\": {\n                          const mac2 = closeMenu(newModel, just(out.data));\n                          return Tuple.fromNative(mac2).mapSecond(c => Cmd.batch([cmd, c])).toNative();\n                        }\n                      }\n                    })\n                    .withDefault(mac);\n              },\n              placementPage => noCmd(model)\n          )\n        }\n        case \"mouse-down\": {\n          // open menu on right click\n          if (mpMsg.button === 2) {\n            return updateMenu(model, TM.open(myMenu, box(model.mousePos, Dim.zero)));\n          }\n          return noCmd(model);\n        }\n      }\n      break;\n    }\n    case \"key-down\": {\n      return model.page.match(\n          () => {\n            // open menu on context menu key\n            if (msg.key === 'ContextMenu') {\n              return updateMenu(model, TM.open(myMenu, box(model.mousePos, Dim.zero)));\n            }\n            return noCmd(model);\n          },\n          () => {\n            // close placement test on ESC\n            if (msg.key === 'Escape') {\n              return noCmd({\n                ...model,\n                page: left(initialMainPage())\n              })\n            }\n            return noCmd(model);\n          }\n      )\n    }\n    case \"mouse-move\": {\n      // keep track of the mouse pos (needed for opening with keyboard)\n      return noCmd({...model, mousePos: msg.pos})\n    }\n    case \"placement-page-msg\": {\n      return noCmd(model);\n    }\n    case \"switch-page\": {\n      return model.page.match(\n          () => openPlacementPage(model),\n          () => noCmd({\n            ...model,\n            page: left(initialMainPage())\n          })\n      )\n    }\n    case \"got-window-dimensions\": {\n      return noCmd({\n        ...model,\n        page: model.page.mapRight(placementPage => ({...placementPage, viewportDim: just(msg.d) }))\n      });\n    }\n  }\n}\n\nconst documentEvents = new DocumentEvents();\nconst windowEvents = new WindowEvents();\n\nexport function subscriptions(model: Model): Sub<Msg> {\n  const mouseMove: Sub<Msg> = documentEvents.on('mousemove', e => onMouseMove(pos(e.pageX, e.pageY)));\n  const keyDown: Sub<Msg> = documentEvents.on('keydown', e => onKeyDown(e.key));\n  return model.page.match(\n      mainPage => {\n        // the menu's subs\n        const menuSub: Sub<Msg> = mainPage.menuModel\n                .map(mm => TM.subscriptions(mm).map(menuMsg).map(mainPageMsg))\n                .withDefaultSupply(() => Sub.none());\n        // mouse & key subs\n        return Sub.batch([menuSub, mouseMove, keyDown]);\n      },\n      () => Sub.batch([\n          mouseMove,\n        keyDown,\n        windowEvents.on('resize', e => gotWindowDimensions(dim(window.innerWidth, window.innerHeight)))\n      ])\n  )\n}\n\n/*\n * Helper functions\n */\n\nfunction updateMenu(model: Model, mac: [MenuModel, Cmd<MenuMsg>]): [Model, Cmd<Msg>] {\n  return model.page.match(\n      mainPage => Tuple.fromNative(mac)\n          .mapFirst(mm => {\n            const newModel: Model = {\n              ...model,\n              page: left({\n                ...mainPage,\n                menuModel: just(mm)\n              })\n            }\n            return newModel;\n            // } ({...model, page: left({ ...mainPage, menuModel: just(mm)}})))\n          })\n          .mapSecond(mc => mc.map(menuMsg).map(mainPageMsg))\n          .toNative(),\n      () => noCmd(model)\n  )\n}\n\nfunction closeMenu(model: Model, lastClicked: Maybe<string> = nothing): [Model, Cmd<Msg>] {\n  const newModel: Model = {\n    ...model,\n    page: model.page.mapLeft(mainPage => ({\n      ...mainPage,\n      menuModel: nothing,\n      lastClicked\n    }))\n  }\n  return noCmd(newModel)\n}\n\n","import React from 'react';\nimport './App.scss';\nimport {DevTools, Program} from \"react-tea-cup\";\nimport * as Demo from './Demo';\n\nfunction App() {\n  return (\n      <Program\n          init={Demo.init}\n          view={Demo.view}\n          update={Demo.update}\n          subscriptions={Demo.subscriptions}\n          devTools={DevTools.init<Demo.Model, Demo.Msg>(window)}\n      />\n  );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n"],"sourceRoot":""}